<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:golive="http://java.sun.com/jsf/composite/components"
	xmlns:filter="http://java.sun.com/jsf/composite/components/filter"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	template="/resources/templates/cadastros/cadastroTemplate.xhtml">

	<ui:param name="bean" value="#{areasDeAtuacaoBean}" />

	<ui:define name="css">
		<h:outputStylesheet name="css/cadastros/style_areasDeAtuacao.css" />
	</ui:define>

	<ui:define name="conteudo">

		<p:dialog id="configuracoesTabela" widgetVar="confTableConteudo"
			modal="true">

			<p:dataTable id="configuracaoTable"
				value="#{areasDeAtuacaoBean.colunasPagina}" var="coluna"
				styleClass="configuracaoPerfil">
				<p:column headerText="#{managerBean.get('label.coluna')}">
					<h:outputLabel
						value="#{managerBean.get(areasDeAtuacaoBean.getLabelFilter(coluna.coluna))}" />
				</p:column>
				<p:column headerText="#{managerBean.get('label.parametros.filtro')}">
					<filter:selectTipoFiltro
						filtro="#{areasDeAtuacaoBean.getFilter(coluna.coluna)}" />
				</p:column>
				<p:column headerText="#{managerBean.get('label.visibilidade')}">
					<p:selectBooleanCheckbox id="selectBooleanVisivel"
						value="#{coluna.visibilidade}" />
				</p:column>

				<f:facet name="footer">
					<p:commandButton id="botaoSalvarConf" 
						value="#{managerBean.get('label.salvar')}"
						actionListener="#{areasDeAtuacaoBean.salvarPerfilPagina()}"
						process="@parent"  update=":conteudoForm:conteudoTable"
						onsuccess="PF('confTableConteudo').hide()" />
				</f:facet>

			</p:dataTable>
		</p:dialog>

		<p:dataTable id="conteudoTable" var="list"
			selection="#{areasDeAtuacaoBean.registro}"
			value="#{areasDeAtuacaoBean.conteudo}" selectionMode="single"
			rowKey="#{list.id}" styleClass="tableCadastros" rows="15"
			paginator="true" widgetVar="table" draggableColumns="true"
			filteredValue="#{areasDeAtuacaoBean.filtrados}"
			emptyMessage="#{managerBean.get('msg.nao.ha.registros')}"
			paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}">

			<f:facet name="header">
				<p:commandButton value="#{managerBean.get('label.configuracoes')}"
					onclick="PF('confTableConteudo').show()" />
			</f:facet>


			<p:ajax event="colReorder"
				listener="#{areasDeAtuacaoBean.guardarOrdemTabela()}"
				update="conteudoTable" />

			<p:ajax event="rowSelect" update="conteudoTable" />
			<p:ajax event="rowUnselect" update="conteudoTable" />

			<p:column id="seletor" selectionMode="single"
				style="width:16px;text-align:center" />

			<p:columns value="#{areasDeAtuacaoBean.configuracaoPerfil}"
				styleClass="colunasStyle" var="coluna" id="columns"
				columnIndexVar="colIndex">
				<f:facet name="header">
					<filter:number id="componentFilterNumberId"
						update=":conteudoForm:conteudoTable"
						rendered="#{areasDeAtuacaoBean.getFilter(coluna.coluna).genericType.simpleName.equals('Long')}"
						widgetAnotado="#{coluna.coluna}" bean="#{areasDeAtuacaoBean}"
						styleClassBotaoLimpar="limpar"
						styleClassFiltroDois="filtroFinal"
						styleClassFiltroUm="filtroInicial"
						styleClassTitulo="tituloColunaFiltro" />
					<filter:string id="componentFilterStringId"
						update=":conteudoForm:conteudoTable"
						rendered="#{areasDeAtuacaoBean.getFilter(coluna.coluna).genericType.simpleName.equals('String')}"
						widgetAnotado="#{coluna.coluna}" bean="#{areasDeAtuacaoBean}"
						styleClassBotaoLimpar="limpar" styleClassBotaoSettings="settings"
						styleClassFiltroUm="filtroInicial"
						styleClassTitulo="tituloColunaFiltro" />
					<filter:date id="componentFilterDateId"
						update=":conteudoForm:conteudoTable"
						rendered="#{areasDeAtuacaoBean.getFilter(coluna.coluna).genericType.simpleName.equals('Date')}"
						widgetAnotado="#{coluna.coluna}" bean="#{areasDeAtuacaoBean}"
						styleClassBotaoLimpar="limpar" styleClassBotaoSettings="settings"
						styleClassFiltroDois="filtroFinal"
						styleClassFiltroUm="filtroInicial"
						styleClassTitulo="tituloColunaFiltro" />
				</f:facet>

				<h:outputText
					rendered="#{areasDeAtuacaoBean.getFilter(coluna.coluna).genericType.simpleName.equals('Date')}"
					value="#{areasDeAtuacaoBean.obterLabelColuna(coluna,list)}">
					<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
				</h:outputText>

				<h:outputText
					rendered="#{!areasDeAtuacaoBean.getFilter(coluna.coluna).genericType.simpleName.equals('Date')}"
					value="#{areasDeAtuacaoBean.obterLabelColuna(coluna,list)}">
				</h:outputText>

			</p:columns>

		</p:dataTable>

	</ui:define>

	<ui:define name="edicao">
		<ui:include
			src="/resources/includes/cadastros/componentsGenericos/dadosGerais.xhtml">
			<ui:param name="pojo" value="#{areasDeAtuacaoBean.registro}" />
			<ui:param name="clazz"
				value="#{areasDeAtuacaoBean.genericClazzInstance}" />

		</ui:include>

	</ui:define>


</ui:composition>